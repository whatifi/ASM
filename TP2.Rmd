---
title: "TP2 Amine Zarbi / Siham Tassouli / Wafae Hatifi"
output: html_document
---
# I) Analyse préliminaire des données de prostate
#### Question 1.a):
```{r}
dataCancer=read.table("prostate.data",header=TRUE)
data = dataCancer[-ncol(dataCancer)] 
pro = as.data.frame(cbind(  data[,1],scale(data[,2:4]),data[,5],scale(data[,6]),data[,7],scale(data[,8:9] ) ))
names(pro) = names(data)
pro
pairs(pro, labels =colnames(dataCancer), pch = 21,bg =c("turquoise"))
```

Si on visualise le graphe des correlations par pairs entre lcavol et  les autres predicteurs, On peut remarquer que le nuage de points entre (lcavol, lpsa)  et (lcavol, lcp) se regroupe autour d'une ligne, en soulignant  un fort alignement  pour le nuage de points (lcavol, lpsa). Pour la visualisation des autres nuages de points  entre lcavol et les autres prédicteurs quantitatifs et qualitatifs, on peut pas déduire une information sur le degré de corrélation.
#### Question 1.b):
En utilisant la commande R <cor> qui  determine le coefficient de correlation entre deux grandeurs on obtien le tableau ci-dessous:
```{r figurename, echo=FALSE, fig.cap="my caption", out.width = '90%'}
knitr::include_graphics("Correla9predicteurs.png")
```
On peut remarque que certains prédicteurs sont corrélés entre eux:
**)svi est corrélé à lcp ; lcavol est corrélé à 
```{r }
proC = pro
n = dim(proC)[1]
proC$svi = factor(proC$svi)
proC$gleason = factor(proC$gleason)
lcavol = proC$lcavol
lmLcavol= lm(lcavol ~ . ,data=proC[,-1])
s = summary(lmLcavol)
s
```

```{r }
proC = pro
n = dim(proC)[1]
proC$svi = factor(proC$svi)
proC$gleason = factor(proC$gleason)
lcavol = proC$lcavol
lmLcavol= lm(lcavol ~ proC$svi+proC$gleason+lweight+age+lbph+pgg45help ,data=proC[,-1])
s = summary(lmLcavol)
s
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
#2e)
t<-qt(1-(0.05/2), 88)
t
```
```{r}
plot(fitted(lmLcavol), data[,1])
y1<-sort.int(fitted(lmLcavol))
y2<-sort.int(data[,1])
plot(1:97,y1, col = "blue")
lines(1:97, y2, col="red")

```
```{r}
hist(lmLcavol$residuals)
```

```{r}
sum(resid(lmLcavol)^2)
```


```{r}
anova <- aov(lcavol ~ factor(svi)*factor(gleason), proC)
model.tables(anova,"means")
summary(anova)
```
```{r}
#part4
lm1<-lm(lcavol~1,data=proC)
lm2<-lm(lcavol~.,data=proC[,c(1,4,9)])
lm3<-lm(lcavol~.,data=proC[,c(1,2,9)])
Combine <- combn(proC[,2:9],2)
Combine[,1]
```

```{r}
RSSmin <- function(k){
  if( k == 0 ){
    lm1 <- lm(lcavol~1,data=proC)
    RSS <- sum(resid(lm1)^2)
    return(RSS,k)
  }
  else{
    RSS = 1000000000000000
    k = 0
    for(i in 1:ncol(Combine)){
      lm <- lm(lcavol~., )
      RS <- sum(resid(lm)^2)
      if(RS < RSS){
        RSS = RS
        k = i
      }
    }
    return(RSS,k)
    
  }
}

s <- as.data.frame(cbind(Combine[,2][1],Combine[,2][2]))
s
#lm <- lm(lcavol~., s)
#summary(lm)
#resultat <- RSSmin(2)
#resultat[1]
```

